(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{412:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"uniapp-小程序-配置萤石监控-直播替代方案-踩坑与解决方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#uniapp-小程序-配置萤石监控-直播替代方案-踩坑与解决方法"}},[t._v("#")]),t._v(" uniapp(小程序) 配置萤石监控(直播替代方案)踩坑与解决方法")]),t._v(" "),s("blockquote",[s("p",[t._v("因为公司业务需求需要获取监控的摄像头，萤石是给出了几种方案去实现。")]),t._v(" "),s("ul",[s("li",[t._v("直播接入："),s("a",{attrs:{href:"https://open.ys7.com/help/30",target:"_blank",rel:"noopener noreferrer"}},[t._v("萤石开放平台API文档"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("小程序接入："),s("a",{attrs:{href:"https://open.ys7.com/help/452",target:"_blank",rel:"noopener noreferrer"}},[t._v("萤石开放平台API文档"),s("OutboundLink")],1)])])]),t._v(" "),s("blockquote",[s("p",[t._v("原计划是使用直播地址接入：")]),t._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221124093452696.png",alt:"image-20221124093452696"}})]),t._v(" "),s("p",[t._v("但是出现了报错：我们的设备编码方式是H265的，且无法转译为H264的格式，无法接入直播地址")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:"C:\\Users\\Administrator\\AppData\\Roaming\\Typora\\typora-user-images\\image-20221124093609579.png",alt:"image-20221124093609579"}}),t._v(" "),s("p",[t._v("只能改用小程序内部插入 "),s("code",[t._v("web-view")]),t._v(" 的方法来嵌入H5的页面。这里我为了方便（因为已经在小程序上写好页面了才发现这个问题），使用uniapp来写这个  "),s("code",[t._v("webview")]),t._v(" 页面。")])]),t._v(" "),s("h2",{attrs:{id:"一、对接萤石监控接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、对接萤石监控接口"}},[t._v("#")]),t._v(" 一、对接萤石监控接口")]),t._v(" "),s("h3",{attrs:{id:"_1、导入-ezuikit-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、导入-ezuikit-js"}},[t._v("#")]),t._v(" 1、导入 "),s("code",[t._v("ezuikit.js")])]),t._v(" "),s("blockquote",[s("p",[t._v("npm 获取 ezuikit-js")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ npm install ezuikit-js\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("blockquote",[s("p",[t._v("部分人（比如我）会出现 npm 导入 ezuikit-js 后无法生效的问题，这就需要使用本地下载引入的方法：")]),t._v(" "),s("p",[t._v("下载地址："),s("a",{attrs:{href:"https://gitee.com/fyhLucky/EZUIKit-JavaScript",target:"_blank",rel:"noopener noreferrer"}},[t._v("EZUIKit-JavaScript"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v("  EZUIKit "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ezuikit-js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"_2、获取监控地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、获取监控地址"}},[t._v("#")]),t._v(" 2、获取监控地址")]),t._v(" "),s("blockquote",[s("p",[t._v("首先登录你的萤石平台，在设备处找到监控地址：")]),t._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221124093452696.png",alt:"image-20221124093452696"}})])]),t._v(" "),s("h3",{attrs:{id:"_3、获取-appkey-和-secret"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、获取-appkey-和-secret"}},[t._v("#")]),t._v(" 3、获取  "),s("code",[t._v("appKey")]),t._v(" 和 "),s("code",[t._v("secret")])]),t._v(" "),s("blockquote",[s("p",[t._v("登录后找到你的 "),s("code",[t._v("appKey")]),t._v(" 和 "),s("code",[t._v("secret")]),t._v(" 用来动态获取 "),s("code",[t._v("accessToken")]),t._v(" 接口:")]),t._v(" "),s("p",[s("img",{attrs:{src:"C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221128101515520.png",alt:"image-20221128101515520"}})])]),t._v(" "),s("h3",{attrs:{id:"_4、调用接口动态获取-accesstoken"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、调用接口动态获取-accesstoken"}},[t._v("#")]),t._v(" 4、调用接口动态获取 "),s("code",[t._v("accessToken")])]),t._v(" "),s("blockquote",[s("p",[t._v("这里直接给出官方文档："),s("a",{attrs:{href:"https://open.ys7.com/doc/zh/book/index/user.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("获取Access Token"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("官方文档描写的比较详细，但是没有具体的代码示例，我在这里贴出来：")])]),t._v(" "),s("div",{staticClass:"language-vue line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-vue"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("MeterOperation-image"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("video-container"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("obj")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("appKey")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这是appKey'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("appSecret")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这是appSecret'")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onLoad")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getVideo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("methods")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取监控")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getVideo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tjq"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://open.ys7.com/api/lapp/token/get"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" accessToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("accessToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\tplayer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EZUIKit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EZUIKitPlayer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 视频容器ID，对应上面的view，会自动变成视频")]),t._v("\n\t\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'video-container'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\t\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("accessToken")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" accessToken"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这里是url咧'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'talk'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 加载插件，talk-对讲")]),t._v("\n\t\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("width")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("480")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 视频宽高自己调，4:3 的宽高比")]),t._v("\n\t\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("height")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("360")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t\twindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("player "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" player"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br")])]),s("blockquote",[s("blockquote",[s("h4",{attrs:{id:"可能出现的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#可能出现的问题"}},[t._v("#")]),t._v(" "),s("strong",[t._v("可能出现的问题：")])])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("视频宽度可能太大撑开页面：")])]),t._v(" "),s("p",[t._v("调取萤石的接口，它会通过 "),s("code",[t._v('id="video-container"')]),t._v(" 直接在页面上创建一个容器，容器使用你在接口中定义的宽高呈现（px）。在我开发的时候就出现了在安卓上适配，而ios页面会被撑开的问题。解决办法是在父容器设置 "),s("code",[t._v("overflow: hidden;")])])])])]),t._v(" "),s("h3",{attrs:{id:"_5、效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5、效果"}},[t._v("#")]),t._v(" 5、效果")]),t._v(" "),s("blockquote",[s("p",[t._v("大概的效果是这样，放的是萤石官网的图，实际实现后只有画面和底部的时间显示，其他效果要另外配置")])]),t._v(" "),s("img",{staticStyle:{zoom:"40%"},attrs:{src:"C:\\Users\\Administrator\\AppData\\Roaming\\Typora\\typora-user-images\\image-20221129092249025.png",alt:"image-20221129092249025"}}),t._v(" "),s("h2",{attrs:{id:"二、webview-导入微信-weixin-webview-jssdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、webview-导入微信-weixin-webview-jssdk"}},[t._v("#")]),t._v(" 二、"),s("code",[t._v("webview")]),t._v(" 导入微信 "),s("code",[t._v("weixin-webview-jssdk")])]),t._v(" "),s("blockquote",[s("p",[t._v("因为业务需求，我需要在 "),s("code",[t._v("webview")]),t._v(" 设置倒计时的功能，3分钟后跳转回到小程序的首页，并且还要传递参数告知页面已销毁，更新接口。")]),t._v(" "),s("p",[t._v("为了满足这个需求，我需要导入 "),s("code",[t._v("weixin-webview-jssdk")]),t._v(" 来实现在 "),s("code",[t._v("webview")]),t._v(" 使用微信小程序的API。")]),t._v(" "),s("p",[t._v("官方文档："),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-view | 微信开放文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"_1、接口说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、接口说明"}},[t._v("#")]),t._v(" 1、接口说明")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-view"),s("OutboundLink")],1),t._v(" 网页中可使用 "),s("a",{attrs:{href:"https://res.wx.qq.com/open/js/jweixin-1.3.2.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSSDK 1.3.2"),s("OutboundLink")],1),t._v(" 提供的接口返回小程序页面。 支持的接口有：")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("接口名")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("最低版本")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("wx.miniProgram.navigateTo")]),t._v(" "),s("td",[t._v("参数与小程序接口一致")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.4"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("wx.miniProgram.navigateBack")]),t._v(" "),s("td",[t._v("参数与小程序接口一致")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.4"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("wx.miniProgram.switchTab")]),t._v(" "),s("td",[t._v("参数与小程序接口一致")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.5"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("wx.miniProgram.reLaunch")]),t._v(" "),s("td",[t._v("参数与小程序接口一致")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.5"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("wx.miniProgram.redirectTo")]),t._v(" "),s("td",[t._v("参数与小程序接口一致")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.5"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("wx.miniProgram.postMessage")]),t._v(" "),s("td",[t._v("向小程序发送消息，会在特定时机（小程序后退、组件销毁、分享）触发组件的 message 事件")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.7.1"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("wx.miniProgram.getEnv")]),t._v(" "),s("td",[t._v("获取当前环境")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.7.1"),s("OutboundLink")],1)])])])]),t._v(" "),s("blockquote",[s("p",[t._v("这里我要跳回的是首页，也就是 "),s("strong",[t._v("Tabar")]),t._v(" 页面，要使用 "),s("code",[t._v("wx.miniProgram.switchTab")])]),t._v(" "),s("p",[t._v("销毁时传递参数，要使用 "),s("code",[t._v("wx.miniProgram.postMessage")])])]),t._v(" "),s("h3",{attrs:{id:"_2、导入-weixin-webview-jssdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、导入-weixin-webview-jssdk"}},[t._v("#")]),t._v(" 2、导入 "),s("code",[t._v("weixin-webview-jssdk")])]),t._v(" "),s("blockquote",[s("p",[t._v("一开始我还是用了下载到本地，本地引入的方法，发现这个方法不生效后，选择了 npm 导入就可以了")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install weixin-js-sdk\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("blockquote",[s("p",[t._v("成功导入后我遇到了两个问题：")]),t._v(" "),s("ul",[s("li",[t._v("跳转失败")]),t._v(" "),s("li",[t._v("postMessage 接收不到参数")])])]),t._v(" "),s("h4",{attrs:{id:"跳转失败"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#跳转失败"}},[t._v("#")]),t._v(" "),s("strong",[t._v("跳转失败")])]),t._v(" "),s("blockquote",[s("p",[t._v("我为了解决这个问题查了很多文档，一开始是因为导入报错，导入成功后提示找不到路径 "),s("code",[t._v('switchTab:fail page "pages/tabbar/home/home" is not found')])]),t._v(" "),s("p",[t._v("最后找到了原因：我使用的是 "),s("em",[s("strong",[t._v("绝对路径")])]),t._v("  而不是 "),s("em",[s("strong",[t._v("相对路径")])])])]),t._v(" "),s("h5",{attrs:{id:"错误案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误案例"}},[t._v("#")]),t._v(" "),s("strong",[t._v("错误案例：")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("wx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("miniProgram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("switchTab")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/pages/tabBar/home/home'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里的绝对路径是无效的")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tthat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'退回成功'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'res'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fail")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(error);")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("complete")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log('complete');")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h5",{attrs:{id:"正确案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#正确案例"}},[t._v("#")]),t._v(" 正确案例：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("wx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("miniProgram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("switchTab")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../tabBar/home/home'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里的相对路径生效")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tthat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'退回成功'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'res'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fail")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(error);")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("complete")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log('complete');")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("h4",{attrs:{id:"postmessage-接收不到参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#postmessage-接收不到参数"}},[t._v("#")]),t._v(" postMessage 接收不到参数")]),t._v(" "),s("blockquote",[s("blockquote",[s("p",[t._v("在这里推荐一篇博客，写的很好（不是我写的），大家可以去看看，包含了H5，uniapp，小程序等多个解决方案，非常详细："),s("a",{attrs:{href:"https://blog.csdn.net/Charissa2017/article/details/119732886",target:"_blank",rel:"noopener noreferrer"}},[t._v("uniapp项目webview页面给小程序传参 postMessage 接收不到参数"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("strong",[t._v("这里的出错主要是在：")])]),t._v(" "),s("ul",[s("li",[t._v("传递的参数错误")]),t._v(" "),s("li",[t._v("接收的函数出错")])])]),t._v(" "),s("h5",{attrs:{id:"传递的参数错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#传递的参数错误"}},[t._v("#")]),t._v(" 传递的参数错误：")]),t._v(" "),s("blockquote",[s("p",[t._v("postMessage传递的参数必须放在data中，否则无法获取")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 错误示例")]),t._v("\nwx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("miniProgram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13500000000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 正确示例")]),t._v("\nwx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("miniProgram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13500000000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h5",{attrs:{id:"接收的函数出错"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#接收的函数出错"}},[t._v("#")]),t._v(" 接收的函数出错：")]),t._v(" "),s("blockquote",[s("p",[t._v("小程序中的 "),s("code",[t._v("webview")]),t._v(" 属性说明：在uniapp中使用了小程序的 "),s("code",[t._v("bindmessage")]),t._v(" 属性")]),t._v(" "),s("p",[t._v("官方文档："),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-view | 微信开放文档"),s("OutboundLink")],1)])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("默认值")]),t._v(" "),s("th",[t._v("必填")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("最低版本")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("src")]),t._v(" "),s("td",[t._v("string")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("webview 指向网页的链接。可打开关联的公众号的文章，其它网页需登录"),s("a",{attrs:{href:"https://mp.weixin.qq.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("小程序管理后台"),s("OutboundLink")],1),t._v("配置业务域名。")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.4"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("bindmessage")]),t._v(" "),s("td",[t._v("eventhandler")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("网页向小程序 postMessage 时，会在特定时机（小程序后退、组件销毁、分享）触发并收到消息。e.detail = { data }，data是多次 postMessage 的参数组成的数组")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.4"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("bindload")]),t._v(" "),s("td",[t._v("eventhandler")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("网页加载成功时候触发此事件。e.detail = { src }")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.4"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("binderror")]),t._v(" "),s("td",[t._v("eventhandler")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("否")]),t._v(" "),s("td",[t._v("网页加载失败的时候触发此事件。e.detail = { url, fullUrl }，其中 fullUrl 为加载失败时的完整 url")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("1.6.4"),s("OutboundLink")],1)])])])]),t._v(" "),s("blockquote",[s("p",[t._v("uniapp中的 "),s("code",[t._v("webview")]),t._v(" 属性说明：使用 "),s("code",[t._v("@message")]),t._v(" 接收就成功了")]),t._v(" "),s("p",[t._v("官方文档："),s("a",{attrs:{href:"https://uniapp.dcloud.net.cn/component/web-view.html#",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-view | uni-app官网"),s("OutboundLink")],1)])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性名")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("平台差异说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("src")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("webview 指向网页的链接")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("allow")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("用于为 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/iframe",target:"_blank",rel:"noopener noreferrer"}},[t._v("iframe"),s("OutboundLink")],1),t._v(" 指定其"),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/%E7%AD%96%E7%95%A5%E7%89%B9%E5%BE%81",target:"_blank",rel:"noopener noreferrer"}},[t._v("特征策略"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("H5")])]),t._v(" "),s("tr",[s("td",[t._v("sandbox")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("该属性对呈现在 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/iframe",target:"_blank",rel:"noopener noreferrer"}},[t._v("iframe"),s("OutboundLink")],1),t._v(" 框架中的内容启用一些额外的限制条件。")]),t._v(" "),s("td",[t._v("H5")])]),t._v(" "),s("tr",[s("td",[t._v("fullscreen")]),t._v(" "),s("td",[t._v("Boolean")]),t._v(" "),s("td",[t._v("是否铺满整个页面，默认值："),s("code",[t._v("true")]),t._v("。")]),t._v(" "),s("td",[t._v("H5 (HBuilder X 3.5.4+)")])]),t._v(" "),s("tr",[s("td",[t._v("webview-styles")]),t._v(" "),s("td",[t._v("Object")]),t._v(" "),s("td",[t._v("webview 的样式")]),t._v(" "),s("td",[t._v("App-vue")])]),t._v(" "),s("tr",[s("td",[t._v("update-title")]),t._v(" "),s("td",[t._v("Boolean")]),t._v(" "),s("td",[t._v("是否自动更新当前页面标题。默认值："),s("code",[t._v("true")])]),t._v(" "),s("td",[t._v("App-vue (HBuilder X 3.3.8+)")])]),t._v(" "),s("tr",[s("td",[t._v("@message")]),t._v(" "),s("td",[t._v("EventHandler")]),t._v(" "),s("td",[t._v("网页向应用 "),s("code",[t._v("postMessage")]),t._v(" 时，会在特定时机（后退、组件销毁、分享）触发并收到消息。")]),t._v(" "),s("td",[t._v("H5 暂不支持（可以直接使用 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage",target:"_blank",rel:"noopener noreferrer"}},[t._v("window.postMessage"),s("OutboundLink")],1),t._v("）")])]),t._v(" "),s("tr",[s("td",[t._v("@onPostMessage")]),t._v(" "),s("td",[t._v("EventHandler")]),t._v(" "),s("td",[t._v("网页向应用实时 "),s("code",[t._v("postMessage")])]),t._v(" "),s("td",[t._v("App-nvue")])])])]),t._v(" "),s("h5",{attrs:{id:"接收代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#接收代码"}},[t._v("#")]),t._v(" 接收代码：")]),t._v(" "),s("div",{staticClass:"language-vue line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-vue"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("web-view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@message")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("handleGetMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("web-view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("liveToken")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("methods")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleGetMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\tconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("detail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("liveToken "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("detail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token style"}},[s("span",{pre:!0,attrs:{class:"token language-css"}},[t._v("\n\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);